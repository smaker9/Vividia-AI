<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIVIDIA AI | Elite Studio</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-color: #030303;
            --panel-bg: rgba(10, 10, 10, 0.7);
            --border-color: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --text-dim: #a0a0a0;
            --accent-purple: #8b5cf6;
            --accent-pink: #d946ef;
            --glass: blur(25px);
        }

        body.light-mode {
            --bg-color: #f0f0f0;
            --panel-bg: rgba(255, 255, 255, 0.9);
            --border-color: rgba(0, 0, 0, 0.1);
            --text-main: #000000;
            --text-dim: #505050;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Poppins', sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            transition: background 0.3s;
        }

        /* --- خلفية متحركة (Particle Network) --- */
        .background-animation {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: radial-gradient(circle at center, #1a1a1a 0%, #030303 100%);
        }

        /* --- الهيكل الزجاجي (Main Panel) --- */
        .main-panel {
            background: var(--panel-bg);
            backdrop-filter: var(--glass);
            -webkit-backdrop-filter: var(--glass);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            width: 90%;
            max-width: 550px;
            padding: 25px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
            position: relative;
        }

        /* --- Header & Theme --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .logo { font-size: 1.6rem; font-weight: 800; letter-spacing: 2px; }
        .theme-toggle { cursor: pointer; color: var(--text-dim); }

        /* --- Prompts --- */
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: var(--text-dim); font-size: 0.85rem; }
        input[type="text"] {
            width: 100%;
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            padding: 10px;
            border-radius: 10px;
            box-sizing: border-box;
        }

        /* --- Icons Services Row --- */
        .services-icons {
            display: flex;
            justify-content: space-around;
            color: var(--text-dim);
            font-size: 1.2rem;
            margin: 20px 0;
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
        }
        .service-item { text-align: center; font-size: 0.75rem; cursor: pointer; transition: 0.3s; }
        .service-item.active { color: var(--accent-pink); }
        .service-item:hover { color: #fff; }

        /* --- Create Button --- */
        .create-btn {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
            color: white;
            border: none;
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            margin-bottom: 20px;
        }

        /* --- Media Preview Box (مُفعل) --- */
        .media-preview {
            width: 100%;
            height: 200px;
            background: #000;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        .media-preview img, .media-preview video, .media-preview audio { max-width: 100%; max-height: 100%; object-fit: contain; }

        /* --- Subscription Panel --- */
        .sub-panel {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--accent-purple);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }
        .price { font-size: 2.2rem; font-weight: 800; margin: 5px 0; }
        .limits { color: var(--text-dim); font-size: 0.8rem; margin-bottom: 15px; }
        .sub-btn {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-pink));
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
        }

        /* --- Bottom Nav --- */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            color: var(--text-dim);
            font-size: 0.8rem;
        }
        .nav-item { text-align: center; cursor: pointer; color: var(--text-dim); transition: 0.3s; }
        .nav-item.active { color: var(--accent-pink); }
        .nav-item:hover { color: #fff; }

        /* أقسام إضافية ديناميكية */
        .panel-section { display: none; }
        .panel-section.active { display: block; }
    </style>
</head>
<body>

    <div class="background-animation"></div>

    <div class="main-panel">
        <div class="header">
            <div class="logo">VIVIDIA AI</div>
            <div class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon" id="theme-icon"></i>
            </div>
        </div>

        <div id="section-home" class="panel-section active">
            <div class="input-group">
                <label>Prompt input:</label>
                <input type="text" id="promptInput" placeholder="Enter your prompt...">
            </div>
            <div class="input-group">
                <input type="text" placeholder="video prompt...">
            </div>
            <div class="input-group">
                <input type="text" placeholder="music prompt...">
            </div>

            <div class="media-preview" id="mediaPreview">
                <img id="imagePlayer" src="" alt="Preview" style="display:none;">
                <video id="videoPlayer" controls style="display:none;"></video>
                <audio id="audioPlayer" controls style="display:none;"></audio>
            </div>

            <div class="services-icons">
                <div class="service-item active" onclick="setService('image')"><i class="fas fa-image"></i><br>Image</div>
                <div class="service-item" onclick="setService('video')"><i class="fas fa-video"></i><br>Video</div>
                <div class="service-item" onclick="setService('music')"><i class="fas fa-music"></i><br>Music</div>
                <div class="service-item" onclick="setService('voice')"><i class="fas fa-microphone"></i><br>Voice</div>
            </div>

            <div style="display:flex; gap:10px; margin-bottom:15px;">
                <button class="create-btn" style="margin:0; padding:10px;" onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-upload"></i> Upload
                </button>
                <input type="file" id="fileInput" style="display:none" onchange="handleFileUpload(this)">
                
                <button class="create-btn" style="margin:0; padding:10px; background:var(--accent-purple);" onclick="downloadMedia()">
                    <i class="fas fa-download"></i> Download
                </button>
            </div>

            <button class="create-btn" onclick="runMagic()">Create Magic</button>

            <div class="sub-panel">
                <div>Unlimited Power</div>
                <div class="price">4.99<span style="font-size:1.2rem;">$/month</span></div>
                <div class="limits">Limits 100 Images | 10 Videos | 20k Voice</div>
                <button class="sub-btn" onclick="window.location.href='https://cryptomus.com/gateway/process'">subscribe abn</button>
            </div>
        </div>

        <div id="section-gallery" class="panel-section"><h3>Gallery</h3></div>
        <div id="section-settings" class="panel-section"><h3>Settings</h3></div>
        <div id="section-profile" class="panel-section"><h3>Profile</h3></div>

        <div class="bottom-nav">
            <div class="nav-item active" onclick="showSection('home')"><i class="fas fa-home"></i><br>home</div>
            <div class="nav-item" onclick="showSection('gallery')"><i class="fas fa-image"></i><br>Gallery</div>
            <div class="nav-item" onclick="showSection('settings')"><i class="fas fa-cogs"></i><br>Settings</div>
            <div class="nav-item" onclick="showSection('profile')"><i class="fas fa-user"></i><br>Profile</div>
        </div>
    </div>

    <script>
        // --- Dark Mode ---
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const icon = document.getElementById('theme-icon');
            icon.classList.toggle('fa-moon');
            icon.classList.toggle('fa-sun');
        }

        // --- Bottom Navigation Logic ---
        function showSection(sectionId) {
            document.querySelectorAll('.panel-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById(`section-${sectionId}`).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // --- Service Selection ---
        function setService(service) {
            document.querySelectorAll('.service-item').forEach(i => i.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.getElementById('promptInput').placeholder = `Enter ${service} prompt...`;
        }

        // --- Upload / Preview Logic (مُفعل لعرض الصورة/الفيديو) ---
        function handleFileUpload(input) {
            const file = input.files[0];
            if(!file) return;

            const mediaPreview = document.getElementById('mediaPreview');
            const imgPlayer = document.getElementById('imagePlayer');
            const vidPlayer = document.getElementById('videoPlayer');
            const audPlayer = document.getElementById('audioPlayer');

            mediaPreview.style.display = 'flex';
            imgPlayer.style.display = 'none';
            vidPlayer.style.display = 'none';
            audPlayer.style.display = 'none';

            const reader = new FileReader();
            reader.onload = function(e) {
                if(file.type.startsWith('image/')) {
                    imgPlayer.src = e.target.result;
                    imgPlayer.style.display = 'block';
                } else if(file.type.startsWith('video/')) {
                    vidPlayer.src = e.target.result;
                    vidPlayer.style.display = 'block';
                } else if(file.type.startsWith('audio/')) {
                    audPlayer.src = e.target.result;
                    audPlayer.style.display = 'block';
                }
            }
            reader.readAsDataURL(file);
        }

        function downloadMedia() {
            alert("Downloading generated media...");
        }

        // --- Core Logic (API Keys & Cryptomus Integration) ---
        async function runMagic() {
            const prompt = document.getElementById('promptInput').value;
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if(!prompt) return alert("Please enter a prompt.");
            
            // ⚙️ 1. التحقق من النقاط (Credits Check) - منطق محاكاة
            const credits = { leonardo: 50, elevenlabs: 15000 };
            if(credits.leonardo < 10) return alert("Not enough Leonardo credits!");
            
            // ⚙️ 2. تحضير البيانات للارسال (FormData for file + text)
            const formData = new FormData();
            formData.append('prompt', prompt);
            if(file) formData.append('media', file);
            
            // ⚙️ 3. إظهار التحميل
            const statusMsg = document.getElementById('statusMsg') || createStatusMsg();
            statusMsg.innerText = "Processing Magic...";
            
            // ⚙️ 4. الإرسال إلى Backend الفعلي (API Call)
            try {
                const response = await fetch('YOUR_BACKEND_URL/api/generate', {
                    method: 'POST',
                    body: formData // إرسال الملف والنص معاً
                });
                
                const result = await response.json();
                
                if(result.success) {
                    statusMsg.innerText = "Magic Created Successfully!";
                    // عرض الملف الناتج في الـ Preview
                    updatePreview(result.mediaUrl, result.mediaType);
                } else {
                    statusMsg.innerText = "Error: " + result.message;
                }
            } catch (error) {
                statusMsg.innerText = "Connection Error";
                console.error(error);
            }
        }

        // دالة مساعدة لإنشاء رسالة الحالة إذا لم تكن موجودة
        function createStatusMsg() {
            const div = document.createElement('div');
            div.id = 'statusMsg';
            div.style.color = '#fff';
            div.style.textAlign = 'center';
            div.style.marginTop = '10px';
            document.querySelector('.main-panel').appendChild(div);
            return div;
        }

        // دالة لتحديث المعاينة بعد استلام الملف من السيرفر
        function updatePreview(url, type) {
            const imgPlayer = document.getElementById('imagePlayer');
            const vidPlayer = document.getElementById('videoPlayer');
            const audPlayer = document.getElementById('audioPlayer');
            const mediaPreview = document.getElementById('mediaPreview');
            
            mediaPreview.style.display = 'flex';
            imgPlayer.style.display = 'none';
            vidPlayer.style.display = 'none';
            audPlayer.style.display = 'none';

            if(type === 'image') {
                imgPlayer.src = url;
                imgPlayer.style.display = 'block';
            } else if(type === 'video') {
                vidPlayer.src = url;
                vidPlayer.style.display = 'block';
            } else if(type === 'audio') {
                audPlayer.src = url;
                audPlayer.style.display = 'block';
            }
        }
    </script>
</body>
</html>
